<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.open.Care">

   <sql id="Where">
      <if test="searchKeyword !=null and searchKeyword !=''">
         <if test="searchCondition !=null and searchCondition !='' and searchCondition ==0">
            AND (TITLE LIKE CONCAT('%',#{searchKeyword},'%') OR CONT like CONCAT('%',#{searchKeyword},'%'))
         </if>
         <if test="searchCondition !=null and searchCondition !='' and searchCondition ==1">
            AND TITLE LIKE CONCAT('%',#{searchKeyword},'%')
         </if>
         <if test="searchCondition !=null and searchCondition !='' and searchCondition ==2">
            AND CONT LIKE CONCAT('%',#{searchKeyword},'%')
         </if>
       </if>
   </sql>
   
   <select id="selectContents" parameterType="careVO" resultType="careVO">
      /* Care.selectContents */
      <![CDATA[
           SELECT CA_SEQ 							caSeq
	            , DATE_FORMAT(CA_RGST_DT,'%Y.%m.%d')caRgstDt
	            , CA_RGST_SEQ 						caRgstSeq
	            , CA_ERUM 							caErum
	            , CA_PHON 							caPhon
	            , CA_VEHI 							caVehi
	            , CA_NUM 							caNum
	            , CA_DEL 							caDel
	            , CA_LOCAL 							caLocal
	            , CA_TF								caTf
	            , CA_ETC 							caEtc
	            , CA_START 							caStart
	            , CA_END 							caEnd
	            , CA_VAC 							caVac
	            , CA_CODE 							caCode
	            , CA_LEV 							caLev
	            , CA_SCO 							caSco
	            , CA_CONT 							caCont
	            , CA_ATCH_FILE_SEQ 					caAtchFileSeq
	         FROM T_CARE 
            WHERE CA_USE_YN='Y'   
              AND CA_SEQ = #{caSeq}
      ]]>
   </select>
   
   
   
   <select id="selectList" parameterType="cmmnDefaultVO" resultType="careVO">
      /* Care.selectList */
      <![CDATA[
           SELECT CA_SEQ 							caSeq
	            , DATE_FORMAT(CA_RGST_DT,'%Y.%m.%d') caRgstDt
	            , CA_RGST_SEQ 						caRgstSeq
	            , CA_ERUM 							caErum
	            , CA_PHON 							caPhon
	            , CA_VEHI 							caVehi
	            , CA_NUM 							caNum
	            , CA_DEL 							caDel
	            , CA_LOCAL 							caLocal
	            , CA_TF								caTf
	            , CA_ETC 							caEtc
	            , CA_START 							caStart
	            , CA_END 							caEnd
	            , CA_VAC 							caVac
	            , CA_CODE 							caCode
	            , CA_LEV 							caLev
	            , CA_SCO 							caSco
	            , CA_CONT 							caCont
	            , CA_ATCH_FILE_SEQ 					caAtchFileSeq
	         FROM T_CARE 
	        WHERE CA_USE_YN='Y'   
         ]]>
           <include refid="Where"/>    
        <![CDATA[ 
             ORDER BY CA_SEQ DESC
             LIMIT #{firstIndex} , #{recordCountPerPage}
      ]]>
   </select>   


   <select id="selectCount" parameterType="cmmnDefaultVO" resultType="int">
      /* Care.selectCount */
      <![CDATA[
         SELECT COUNT(CA_SEQ) cnt 
           FROM T_CARE
          WHERE CA_USE_YN='Y' 
      ]]>
          <include refid="Where"/>
   </select>
   
   <insert id="insertContents" parameterType="careVO">
      /* Care.insertContents */
      <![CDATA[
           INSERT INTO T_CARE(
	              CA_SEQ 
	            , CA_RGST_SEQ 
	            , CA_ERUM 
	            , CA_PHON
	            , CA_VEHI 
	            , CA_NUM 
	            , CA_DEL
	            , CA_LOCAL
	            , CA_TF 							
	            , CA_ETC 							
	            , CA_START 							
	            , CA_END 							
	            , CA_VAC 							
	            , CA_CODE
	            , CA_LEV
	            , CA_SCO
	            , CA_CONT
	            , CA_ATCH_FILE_SEQ 
	         )
         VALUES (
             (SELECT IFNULL(MAX(CA.CA_SEQ)+1,1) FROM T_CARE CA)
	            , #{caRgstSeq}
	            , #{caErum}
	            , #{caPhon}
	            , #{caVehi}
	            , #{caNum}
	            , #{caDel}
	            , #{caLocal}
	            , #{caTf}
	            , #{caEtc}
	            , #{caStart}
	            , #{caEnd}
	            , #{caVac}
	            , #{caCode}
	            , #{caLev}
	            , #{caSco}
	            , #{caCont}
	            , #{caAtchFileSeq}
	         )
      ]]>
   </insert>
   
   <update id="updateContents" parameterType="careVO">
      /* Care.updateContents */
      <![CDATA[
           UPDATE T_CARE     
	          SET CA_ERUM 			= #{caErum} 
	            , CA_RVSE_DT 		= NOW()
	            , CA_PHON 			= #{caPhon}
	            , CA_VEHI  			= #{caVehi}
	            , CA_NUM  			= #{caNum}
	            , CA_DEL 			= #{caDel}
	            , CA_LOCAL 			= #{caLocal}
	            , CA_TF 			= #{caTf}
	            , CA_ETC 			= #{caEtc}
	            , CA_START 			= #{caStart}
	            , CA_END 			= #{caEnd}
	            , CA_VAC 			= #{caVac}
	            , CA_CODE 			= #{caCode}
	            , CA_LEV 			= #{caLev}
	            , CA_SCO 			= #{caSco}
	            , CA_CONT 			= #{caCont}
	            , CA_ATCH_FILE_SEQ 	= #{caAtchFileSeq}
	        WHERE CA_SEQ = #{caSeq}  
      ]]>
   </update>
   
   <update id="deleteContents" parameterType="careVO">
      /* Care.deleteContents */
      <![CDATA[
          UPDATE T_CARE
             SET CA_USE_YN='N'
           WHERE CA_SEQ=#{caSeq}
      ]]>
   </update>


   
   
   
   
</mapper>